# 仕様

## 概要

- ここん（kokon）は古今東西ゲームを補助するためのSPAです
- 単語データをspreadsheetから取得し、ユーザーの入力（タイピング/任意で発話）に対して正解・不正解を提示します
- Desktop / Mobile 両方のブラウザに対応

## 採用技術

- React
- Vite
- tailwindcss
- HeroUI (必要に応じて)
- csv-parse（spreadsheetのパース）
- Vitest

## 画面構成

- 「単語リスト」「設定・オプション」で構成される
- 単語リスト
  - 単語データをテーブルとして表示
  - カテゴリごとテーブルを分ける
  - テーブルは横に複数列で配置する
  - 初期状態では単語は伏せられており、正解すると表示される
- 設定・オプション
  - 「spreadsheetのURL入力欄」「データを開くリンク」「回答状況のリセットボタン」「画像の表示非表示」「音声認識のON/OFF」などがある
  - ハンバーガーメニューから横スライドで表示する
  - spreadsheetのURLはlocalStorageに保存する
  - 音声認識のON/OFFはlocalStorageに保存する
  - 音声認識はPCブラウザ向けのオプションとして案内する
  - localStorageにURLがある場合は自動で読み込む
  - 読み込み対象はスプレッドシートの1シート目
  - オンデバイス音声の準備ボタンがある
- 入力
  - タイピング用の入力オーバーレイと、音声認識の結果オーバーレイを表示する
  - 入力欄のそばにIMEの予測変換を無効にする案内を表示する
  - モバイルでは右下の入力ボタンからタイピング入力を開ける

## ユースケース1: 回答データ取得・表示

- spreadsheetのURLからデータを取得する（Google Sheets 共有URLを想定）
- データは「カテゴリ」「単語」「読み」「画像」から構成される。画像はないこともある
- データはスプレッドシートのヘッダー必須・順序不問で取得する
- カテゴリごとテーブルとして表示する（読みは表示しない）
- カテゴリごとテーブルとして表示する（読みは右寄せ・セカンダリカラーで正解時のみ表示する）
- 初期状態は単語・画像は伏せられている
- 正解した単語・画像は表示する

## ユースケース2: ゲームプレイ

- ユーザーはタイピングで回答する
- 任意で音声認識を有効化できる
- 音声認識を有効にした場合、スペースキーを押している間に発話する
- 発話取得は Web Speech API を使う
- タイピング入力はエンターで確定する
- 入力（タイピング/発話）と一致する「単語」または「読み」があるかチェックする
- 「単語」「読み」の照合は空白を無視して一致判定する
- 一致する「読み」が複数ある場合は複数正解とする
- 一致する「読み」がない場合は不正解とする
- 正解の場合は正解音を鳴らし、該当する単語・画像を表示する
- 正解が複数ある場合はすべて表示する
- 不正解の場合は不正解音を鳴らす
- 正解時は該当するデータ行までスクロールし、数秒ハイライトする
- 効果音は public/sounds/correct.mp3 と public/sounds/incorrect.mp3 を再生する
